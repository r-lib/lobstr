# Inspect an object

`sxp(x)` is similar to `.Internal(inspect(x))`, recursing into the C
data structures underlying any R object. The main difference is the
output is a little more compact, it recurses fully, and avoids getting
stuck in infinite loops by using a depth-first search. It also returns a
list that you can compute with, and carefully uses colour to highlight
the most important details.

## Usage

``` r
sxp(x, expand = character(), max_depth = 5L)
```

## Arguments

- x:

  Object to inspect

- expand:

  Optionally, expand components of the true that are usually suppressed.
  Use:

  - "character" to show underlying entries in the global string pool.

  - "environment" to show the underlying hashtables.

  - "altrep" to show the underlying data.

  - "call" to show the full AST (but
    [`ast()`](https://lobstr.r-lib.org/dev/reference/ast.md) is usually
    superior)

  - "bytecode" to show generated bytecode.

- max_depth:

  Maximum depth to recurse. Use `max_depth = Inf` (with care!) to
  recurse as deeply as possible. Skipped elements will be shown as
  `...`.\`

## Details

The name `sxp` comes from `SEXP`, the name of the C data structure that
underlies all R objects.

## See also

Other object inspectors:
[`ast()`](https://lobstr.r-lib.org/dev/reference/ast.md),
[`ref()`](https://lobstr.r-lib.org/dev/reference/ref.md)

## Examples

``` r
x <- list(
  TRUE,
  1L,
  runif(100),
  "3"
)
sxp(x)
#> [1:0x55fdf418eca8] <VECSXP[4]> (refs:2+)
#>   [2:0x55fdf4c3aa98] <LGLSXP[1]> (refs:2+)
#>   [3:0x55fdf4c3a8d8] <INTSXP[1]> (refs:2+)
#>   [4:0x55fdf2d235d0] <REALSXP[100]> (refs:1)
#>   [5:0x55fdf4c3a280] <STRSXP[1]> (refs:2+)

# Expand "character" to see underlying CHARSXP entries in the global
# string pool
x <- c("banana", "banana", "apple", "banana")
sxp(x)
#> [1:0x55fdf3ef2218] <STRSXP[4]> (refs:2+)
sxp(x, expand = "character")
#> [1:0x55fdf3ef2218] <STRSXP[4]> (refs:2+)
#>   [2:0x55fdf4942ac8] <CHARSXP> (refs:2+)
#>   [2:0x55fdf4942ac8]
#>   [3:0x55fdf4244878] <CHARSXP> (refs:2+)
#>   [2:0x55fdf4942ac8]

# Expand altrep to see underlying data
x <- 1:10
sxp(x)
#> [1:0x55fdf4ef70f8] <INTSXP[10]> (altrep refs:2+)
sxp(x, expand = "altrep")
#> [1:0x55fdf4ef70f8] <INTSXP[10]> (altrep refs:2+)
#>   _class [2:0x55fdedda7c20] <RAWSXP[144]> (refs:2+)
#>     _attrib [3:0x55fdedddd638] <LISTSXP> (refs:1)
#>       [4:0x55fdedddd868] <SYMSXP: compact_intseq> (refs:2+)
#>       [5:0x55fdedda92c0] <SYMSXP: base> (refs:2+)
#>       [6:0x55fdedddc128] <INTSXP[1]> (refs:2+)
#>   _data1 [7:0x55fdf1e43968] <REALSXP[3]> (refs:1)
#>   _data2 <NILSXP>

# Expand environmnets to see the underlying implementation details
e1 <- new.env(hash = FALSE, parent = emptyenv(), size = 3L)
e2 <- new.env(hash = TRUE, parent = emptyenv(), size = 3L)
e1$x <- e2$x <- 1:10

sxp(e1)
#> [1:0x55fdf5161e78] <ENVSXP> (refs:2+)
#>   x [2:0x55fdf51ba518] <INTSXP[10]> (altrep refs:2+)
#>   _enclos [3:0x55fdeddaa5c8] <ENVSXP: empty> (refs:2+)
sxp(e1, expand = "environment")
#> [1:0x55fdf5161e78] <ENVSXP> (refs:2+)
#>   _frame [2:0x55fdf51b9ef8] <LISTSXP> (refs:1)
#>     x [3:0x55fdf51ba518] <INTSXP[10]> (altrep refs:2+)
#>   _hashtab <NILSXP>
#>   _enclos [5:0x55fdeddaa5c8] <ENVSXP: empty> (refs:2+)
sxp(e2, expand = "environment")
#> [1:0x55fdf518d3c0] <ENVSXP> (refs:2+)
#>   _frame <NILSXP>
#>   _hashtab [3:0x55fdf272a058] <VECSXP[3]> (refs:1)
#>     [4:0x55fdf51ba208] <LISTSXP> (refs:1)
#>       x [5:0x55fdf51ba518] <INTSXP[10]> (altrep refs:2+)
#>     <NILSXP>
#>     <NILSXP>
#>   _enclos [6:0x55fdeddaa5c8] <ENVSXP: empty> (refs:2+)
```
